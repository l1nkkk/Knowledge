<!DOCTYPE html>
<!-- saved from url=(0063)http://xhu.co.cnki.net/Student/Home.html?r=0.03820257501946256# -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <title></title>
    <link rel="stylesheet" href="./base(1).css">
    <link rel="stylesheet" href="./easyui(1).css">

    <script type="text/javascript" src="./jquery.min(1).js"></script>
    <script type="text/javascript" src="./jquery.cookie(1).js"></script>
    <script type="text/javascript" src="./jquery.extend(1).js"></script>
    <script type="text/javascript" src="./jquery.easyui.min(1).js"></script>
    <script type="text/javascript" src="./common(1).js"></script>
    <script type="text/javascript" src="./constant(1).js"></script>
    <script type="text/javascript" src="./data.output.js"></script>
    <script type="text/javascript" src="./Dictionary(1).js"></script>
    <script type="text/javascript" src="./JSEncrypt(1).js"></script>
    <script type="text/javascript" src="./jquery.qrcode.min.js"></script>
    <!--[if lt IE 9]>
        <script type="text/javascript" src="../Scripts/json2.js?r=2020042314350223"></script>
    <![endif]-->

    <style>
        div {
            box-sizing: border-box;
        }

        .a-text {
            display: inline;
        }

        [name*="none"] {
            display: none;
        }

        .zd-box {
            height: 108px;
            line-height: 66px;
            font-size: 12px;
        }

        .tablebox td {
            padding: 20px 0 20px 4px;
            border: 1px solid #e3e3e3;
        }

            .tablebox td:first-child {
                text-align: right;
                background-color: #f5f6f5;
                color: #313030;
                white-space: nowrap;
            }
    </style>
</head>
<body>
    <div class="main">
        <!--<div style="padding: 10px 0;">
            <a id="switchover" class="listA" href="javascript:;">登录到研学</a>
        </div>-->
        <!--快捷导航-->
        <ul class="rapid-nav margt clearfix">
            <li><i class="sign"></i><a class="listA" href="http://xhu.co.cnki.net/Student/Home.html?r=0.03820257501946256#my_task">我的题目</a></li>
            <li><a class="listA" href="http://xhu.co.cnki.net/Student/Home.html?r=0.03820257501946256#my_word">我的过程文档</a></li>
            <li><a class="listA" href="http://xhu.co.cnki.net/Student/Home.html?r=0.03820257501946256#my_team">我的答辩组</a></li>
            <li><a class="listA disNone" id="nav_btn" href="http://xhu.co.cnki.net/Student/Home.html?r=0.03820257501946256#my_grade" style="display: inline;">我的成绩</a></li>
            <li><a class="listA" href="http://xhu.co.cnki.net/Student/Home.html?r=0.03820257501946256#export_document">导出文档</a></li>
        </ul>
        <!--进度提示-->
        <div id="progress_bar">
            <div class="gxf_problem gxf_problem_detail">
                <div><h2><span></span>进度提示</h2></div>
            </div>
            <div class="bgcbox margt">
                <div class="margb"><i class="txt_red">*</i><span class="color-box greenBox"></span>表示已完成的工作阶段，<span class="color-box orangeBox"></span>表示正在进行的工作阶段，<span class="color-box wathetBox"></span>表示尚未开始的工作阶段；<span class="color-box grayBox"></span>表示未对该项操作进行时间设置（以当前所处时间与设置的时间段比较后进行提示）</div>
                <!--进度块的盒子-->
                <div id="plan_box" class="clearfix  margt"><div class="modules plan-bgc-gray" name="申报题目" star="未设置" end="未设置" bor="plan-bor-gray" color="plan-font-gray" plantext="未设置时间节点时间段范围">申报题目</div><div class="modules plan-bgc-gray" name="选题" star="未设置" end="未设置" bor="plan-bor-gray" color="plan-font-gray" plantext="未设置时间节点时间段范围">选题</div><div class="modules plan-bgc-gray" name="提交任务书" star="未设置" end="未设置" bor="plan-bor-gray" color="plan-font-gray" plantext="未设置时间节点时间段范围">提交任务书</div><div class="modules plan-bgc-gray" name="提交开题报告" star="未设置" end="未设置" bor="plan-bor-gray" color="plan-font-gray" plantext="未设置时间节点时间段范围">提交开题报告</div><div class="modules plan-bgc-gray" name="提交中期检查" star="未设置" end="未设置" bor="plan-bor-gray" color="plan-font-gray" plantext="未设置时间节点时间段范围">提交中期检查</div><div class="modules plan-bgc-gray" name="提交指导记录" leixing="4" star="未设置" end="未设置" bor="plan-bor-gray" color="plan-font-gray" plantext="未设置时间节点时间段范围">提交指导记录</div><div class="modules plan-bgc-gray" name="提交文献综述" star="未设置" end="未设置" bor="plan-bor-gray" color="plan-font-gray" plantext="未设置时间节点时间段范围">提交文献综述</div><div class="modules plan-bgc-gray" name="提交外文译文和原件" star="未设置" end="未设置" bor="plan-bor-gray" color="plan-font-gray" plantext="未设置时间节点时间段范围">提交外文译文和原件</div><div class="modules plan-bgc-gray" name="提交初稿" star="未设置" end="未设置" bor="plan-bor-gray" color="plan-font-gray" plantext="未设置时间节点时间段范围">提交初稿</div><div class="modules plan-bgc-gray" isajax="lunwen" minmax="已设置3次" name="提交毕业论文" bor="plan-bor-gray" color="plan-font-gray" plantext="未设置时间节点时间段范围">提交毕业论文</div><div class="modules plan-bgc-gray" name="评审答辩" star="未设置" end="未设置" bor="plan-bor-gray" color="plan-font-gray" plantext="未设置时间节点时间段范围">评审答辩</div></div>
            </div>
            <div id="title_box" style=" padding: 6px 12px;box-sizing: border-box;display:none;margin-top:-1px;">
                <p><span class="caption clearStyle" id="topic"></span><span class="margl"><i style="font-size:20px" id="mark">★</i><i id="text_plan"></i></span></p>
                <div id="single">
                    <p>
                        <span> 开始时间：<i id="star"></i></span> <span class="margl">截止时间：<i id="end"></i></span>
                    </p>
                </div>
                <!--指导记录提交的方式-->
                <p id="sub_role_type" class="disNone txt_red"></p>

                <div id="multiple" class="disNone">
                    <p id="nub_text"></p>
                    <div id="html_multiple">
                    </div>
                </div>
            </div>
        </div>

        <!--师生预选-->
        <div id="preSelectBox" style="display: none;">
            <div class="gxf_problem gxf_problem_detail">
                <div><h2><span></span>我的预选方向</h2></div>
            </div>
            <div class="my-subject">
                <p> <a href="javascript:goToPreSelectList();" class="radiusBtn main-l">预选方向</a> </p>
                <div class="my-row clearfix" style="height:auto; line-height:40px;">
                    <div class="my-row-l"> 预选方向： </div>
                    <div class="my-row-r" style="height:auto;">
                        <div style="width:100%; height:auto;">
                            <span id="preSelectTitleDetails">&nbsp;</span>
                        </div>
                    </div>
                </div>
                <!--指导教师、联系方式-->
                <div class="my-row" style="border-top: 1px solid #cfcfcf; padding-left:0;padding-top: 5px">
                    <div class="my-teacher">
                        <div class="my-row-l">
                            <span class="teacher-icon"></span>
                            指导教师：
                        </div>
                        <div id="preSelectTeaName" class="my-row-r"> </div>
                    </div>
                    <div class="my-relation">
                        <div class="my-row-l">
                            <span class="tel"></span>
                            联系方式：
                        </div>
                        <div id="preSelectTeaPhone" class="my-row-r"> </div>
                    </div>
                </div>
            </div>
        </div>
        <!--我的题目-->
        <div id="my_task">
            <div class="gxf_problem gxf_problem_detail">
                <div><h2><span></span>我的题目</h2></div>
            </div>
            <div class="my-subject">
                <!--第一行文字和两个按钮-->
                <p style="margin-bottom:18px;">
                    <a id="teaprojectLink" href="http://xhu.co.cnki.net/Student/Home.html?r=0.03820257501946256#" class="radiusBtn main-l" style="">点击选题</a>
                    <a id="stuprojectLink" href="http://xhu.co.cnki.net/Student/Home.html?r=0.03820257501946256#" class="radiusBtn margl" style="display:none;">申报题目</a>
                    <a id="xuantifenxi" href="http://xhu.co.cnki.net/Student/Home.html?r=0.03820257501946256#" class="radiusBtn margl" style="">选题分析</a>
                    <a id="UpdateProject" href="http://xhu.co.cnki.net/Student/Home.html?r=0.03820257501946256#" class="radiusBtn margl" style="display:none;"></a>
                    <a id="refuse" class="radiusBtn main-l" style="display:none;">拒绝题目</a>
                </p>

                <!--题目-->
                <div class="my-row clearfix" style="height:auto; line-height:22px;">
                    <div class="my-row-l">
                        题目：
                    </div>
                    <div class="my-row-r" style="height:auto;">
                        <div style="width:100%; height:auto;">
                            <!--题目数量-->
                            <span name="none-tow">已有 <i id="subject_nuber" class="subject-nuber">1</i>个题目</span>
                            <!--题目的名字-->
                            <span id="task_topic">基于微服务的安全管理监控分析系统【团队题目】</span>
                            <a id="aProject" href="javascript:;" name="none-one" class="margl a-text" style="display: inline;">查看详情</a>
                            <a id="aProject_one" href="javascript:;" name="none-tow" class="margl a-text">查看详情</a>
                        </div>
                        <!--<a href="#" class="a-text">导出题目信息</a>-->
                    </div>
                </div>

                <!--审核状态-->
                <div id="shzt" class="my-row">
                    <div class="my-row-l">
                        审核状态：
                    </div>
                    <div class="my-row-r">
                        <div id="audit_state"><span class="txt_green">审核通过</span></div>
                    </div>
                </div>

                <!--任务书-->
                <div id="TaskIsShow" class="my-row" style="">
                    <div class="my-row-l">
                        任务书：
                    </div>
                    <div class="my-row-r">
                        <a id="task" href="javascript:;" class="a-text">查看任务书</a>
                        <!--<a href="#" class="a-text">导出任务书信息</a>-->
                    </div>
                </div>

                <!--指导教师、联系方式-->
                <div class="my-row" name="none-one" style="display: block;">
                    <div class="my-teacher">
                        <div class="my-row-l">
                            <span class="teacher-icon"></span>
                            指导教师：
                        </div>
                        <div id="teacher_name" class="my-row-r">牛宪华&nbsp;(0120120029)&nbsp;/&nbsp;计算机与软件工程学院&nbsp;/&nbsp;教授</div>
                    </div>
                    <div class="my-relation">
                        <div class="my-row-l">
                            <span class="tel"></span>
                            联系方式：
                        </div>
                        <div id="tel_mail" class="my-row-r"></div>
                    </div>
                </div>
            </div>
        </div>
        <!--过程文档信息-->
        <div id="my_word">
            <div class="gxf_problem gxf_problem_detail">
                <div><h2><span></span>过程文档信息</h2></div>
            </div>
            <div class="tablebox">
                <table class="margb" border="1" style="border:1px solid  #e3e3e3;width:100%">
                    <tbody>
                        <!--开题报告行-->
                        <tr id="proposal" style="">
                            <td><span class="dictionary_1">开题报告</span>：</td>
                            <td><div id="open_topic"><span class="wd-nosub">未提交</span></div></td>
                            <td>
                                <span id="yunxuxiugai_tow" class="redcolor margr" style="display:none;">允许修改1次</span>
                                <a id="open_topic_a" href="http://xhu.co.cnki.net/Student/Home.html?r=0.03820257501946256#" class="a-text">查看详情</a>
                            </td>
                        </tr>
                        <!--初期检查行-->
                        <tr id="earlycheck" style="display:none">
                            <td><span class="dictionary_7">初期检查</span>：</td>
                            <td><div id="early"><span class="wd-nosub">未提交</span></div></td>
                            <td>
                                <span id="yunxuxiugai_six" class="redcolor margr" style="display:none;">允许修改1次</span>
                                <a id="early_a" href="http://xhu.co.cnki.net/Student/Home.html?r=0.03820257501946256#" class="a-text">查看详情</a>
                            </td>
                        </tr>
                        <!--中期报告行-->
                        <tr id="metaphase" style="">
                            <td width="10%"><span class="dictionary_2">中期检查</span>：</td>
                            <td width="30%"><div id="centre_report"><span class="txt_green">已提交</span><span class="txt_yellow margl">等待指导教师审核</span></div></td>
                            <td width="60%">
                                <span id="yunxuxiugai_four" class="redcolor margr" style="display:none;">允许修改1次</span>
                                <a id="centre_report_a" href="http://xhu.co.cnki.net/Student/Home.html?r=0.03820257501946256#" class="a-text">查看详情</a>
                            </td>
                        </tr>
                        <!--写作记录行-->
                        <tr id="Writing" style="display:none">
                            <td><span class="dictionary_9">写作记录卡</span>：</td>
                            <td><div id="WritingRecord"><span class="wd-nosub">未提交</span></div></td>
                            <td>
                                <span id="yunxuxiugai_16" class="redcolor margr" style="display:none;">允许修改1次</span>
                                <a id="WritingRecord_a" href="http://xhu.co.cnki.net/Student/Home.html?r=0.03820257501946256#" class="a-text">查看详情</a>
                            </td>
                        </tr>
                        <!--指导记录行-->
                        <tr id="adviser" style="">
                            <td><span class="dictionary_3">指导记录</span>：</td>
                            <td><div id="adviser_record"><span class="txt_green">已提交</span><span class="txt_yellow margl">等待指导教师审核</span></div></td>
                            <td>
                                <span id="yunxuxiugai_three" class="redcolor margr" style="display:none;">允许修改1次</span>
                                <a id="adviser_record_a" href="http://xhu.co.cnki.net/Student/Home.html?r=0.03820257501946256#" class="a-text">查看详情</a>
                            </td>
                        </tr>
                        <!--外文行-->
                        <tr id="foreign_language" style="">
                            <td><span class="dictionary_4">外文译文和原件</span>：</td>
                            <td><div id="translate"><span class="wd-nosub">未提交</span></div></td>
                            <td>
                                <span id="yunxuxiugai_one" class="redcolor margr" style="display:none;">允许修改1次</span>
                                <a id="translate_a" href="http://xhu.co.cnki.net/Student/Home.html?r=0.03820257501946256#" class="a-text">查看详情</a>
                            </td>
                        </tr>
                        <!--文献综述行-->
                        <tr id="literature_summarize" style="">
                            <td><span class="dictionary_5">文献综述</span>：</td>
                            <td><div id="literature"><span class="wd-nosub">未提交</span></div></td>
                            <td>
                                <span id="yunxuxiugai_five" class="redcolor margr" style="display:none;">允许修改1次</span>
                                <a id="literature_a" href="http://xhu.co.cnki.net/Student/Home.html?r=0.03820257501946256#" class="a-text">查看详情</a>
                            </td>
                        </tr>
                        <!--初稿行-->
                        <tr id="paperDraft" style="">
                            <td><span class="dictionary_8">初稿</span>：</td>
                            <td><div id="Draft"><span class="wd-nosub">未提交</span></div></td>
                            <td>
                                <!--<sapn id="overrun" class="redcolor margr" name="none">允许提交（超权限）1次</sapn>
            <sapn id="last" class="redcolor  margr" name="none">允许提交（最终版）</sapn>-->
                                <a id="Draft_a" href="http://xhu.co.cnki.net/Student/Home.html?r=0.03820257501946256#" class="a-text">查看详情</a>
                            </td>
                        </tr>
                        <!--毕业设计（论文）行-->
                        <tr id="thesis" style="">
                            <td><span class="dictionary_6">毕业论文</span>：</td>
                            <td><div id="paper"><span class="wd-nosub">未提交</span></div></td>
                            <td>
                                <sapn id="overrun" class="redcolor margr" name="none">允许提交（超权限）1次</sapn>
                                <sapn id="last" class="redcolor  margr" name="none">允许提交（最终版）</sapn>
                                <a id="paper_a" href="http://xhu.co.cnki.net/Student/Home.html?r=0.03820257501946256#" class="a-text">查看详情</a>
                            </td>
                        </tr>

                    </tbody>
                </table>

            </div>

            <!-- <div> -->
            <!--开题报告行-->
            <!--<div id="proposal" class="wd-row clearfix" style="display:none;">
                <div class=" wd-row-l"><span class="dictionary_1"></span>：</div>
                <div class="wd-row-r">
                    <div id="open_topic" class="row-r-left"></div>
                    <div class="row-r-right">
                        <span id="yunxuxiugai_tow" class="redcolor margr" style="display:none;">允许修改1次</span>
                        <a id="open_topic_a" href="#" class="a-text">查看详情</a>
                    </div>
                </div>
            </div>-->
            <!--中期报告行-->
            <!--<div id="metaphase" class="wd-row clearfix" style="display:none;">
                <div class="wd-row-l"><span class="dictionary_2"></span>：</div>
                <div class="wd-row-r">
                    <div id="centre_report" class="row-r-left"></div>
                    <div class="row-r-right">
                        <span id="yunxuxiugai_four" class="redcolor margr" style="display:none;">允许修改1次</span>
                        <a id="centre_report_a" href="#" class="a-text">查看详情</a>
                    </div>
                </div>
            </div>-->
            <!--指导记录行-->
            <!--<div id="adviser" class="wd-row clearfix" style="display:none;">
                <div class="wd-row-l"><span class="dictionary_3"></span>：</div>
                <div class="wd-row-r">
                    <div id="adviser_record" class="row-r-left"></div>
                    <div class="row-r-right">
                        <span id="yunxuxiugai_three" class="redcolor margr" style="display:none;">允许修改1次</span>
                        <a id="adviser_record_a" href="#" class="a-text">查看详情</a>
                    </div>
                </div>
            </div>-->
            <!--外文行-->
            <!--<div id="foreign_language" class="wd-row clearfix" style="display:none;">
                <div class="wd-row-l"><span class="dictionary_4"></span>：</div>
                <div class="wd-row-r">
                    <div id="translate" class="row-r-left"> </div>
                    <div class="row-r-right">
                        <span id="yunxuxiugai_one" class="redcolor margr" style="display:none;">允许修改1次</span>
                        <a id="translate_a" href="#" class="a-text">查看详情</a>
                    </div>
                </div>
            </div>-->
            <!--文献综述行-->
            <!--<div id="literature_summarize" class="wd-row clearfix" style="display:none;">
                <div class="wd-row-l"><span class="dictionary_5"></span>：</div>
                <div class="wd-row-r">
                    <div id="literature" class="row-r-left"> </div>
                    <div class="row-r-right">
                        <span id="yunxuxiugai_five" class="redcolor margr" style="display:none;">允许修改1次</span>
                        <a id="literature_a" href="#" class="a-text">查看详情</a>
                    </div>
                </div>
            </div>-->
            <!--毕业设计（论文）行-->
            <!--<div id="thesis" class="wd-row wd-row-btm clearfix wd-row-btm" style="display:none;">
                <div class=" wd-row-l"> <span class="dictionary_6"></span>： </div>
                <div class="wd-row-r">
                    <div id="paper" class="row-r-left"></div>
                    <div class="row-r-right">
                        <sapn id="overrun" class="redcolor margr" name="none">允许提交（超权限）1次</sapn>
                        <sapn id="last" class="redcolor  margr" name="none">允许提交（最终版）</sapn>
                        <a id="paper_a" href="#" class="a-text">查看详情</a>
                    </div>
                </div>
            </div>-->
            <!--</div>-->
        </div>
        <!--我的答辩组-->
        <div id="my_team">
            <div class="gxf_problem gxf_problem_detail">
                <div><h2><span></span>我的答辩组</h2></div>
            </div>
            <div class="my-subject">
                <!--开题答辩组-->
                <div class="my-row clearfix" id="open_reply" style="display:none; height:auto; line-height:24px;border-bottom:1px solid #cfcfcf">
                    <div class="my-row-l">
                        开题答辩组：
                    </div>
                    <div class="my-row-r clearfix answer" style="height:auto;">
                        <div>
                            <span id="openRreply_text" class="margr">你已安排开题答辩 </span>
                        </div>
                        <div id="open_btn_box" style="height:auto; display:none;">
                            <a id="open_one" href="javascript:;" class="a-text margr">查看开题答辩安排</a>
                            <a id="open_tow" href="javascript:;" class="a-text">查看开题答辩结论</a>
                        </div>
                    </div>
                </div>
                <!--答辩情况-->
                <div class="my-row margt clearfix" id="answer_reply" style="height:auto; line-height:24px;">
                    <div class="my-row-l">
                        答辩情况：
                    </div>
                    <div class="my-row-r clearfix answer" style="height:auto;">
                        <div>
                            <span id="answer_number" class="margr">您还未安排答辩</span>
                            <!--<span id="answer_text"></span>-->
                        </div>
                        <div style="height:auto;">
                            <a id="anpai" href="javascript:;" class="a-text margr" style="display: none;">查看答辩安排</a>
                            <a id="jilu" href="javascript:;" class="a-text" style="display: none;">查看答辩记录</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--错误信息提示框-->
        <div id="nochoiceDiv" class="gxf_tips" style="display:none; margin-bottom:15px; margin:30px 0 0 0">
            <div class="gxf_tip">
                <i></i>信息提示
            </div>
            <div>
                <p id="p_tishi"></p>
            </div>
        </div>

        <!--我的成绩-->
        <div id="my_grade" class="disNone" style="display: block;">
            <div class="gxf_problem gxf_problem_detail">
                <div><h2><span></span>我的成绩</h2></div>
            </div>
            <div class="my-subject">
                <!--总成绩-->
                <div class="my-row clearfix">
                    <div class="my-row-l font-style">
                        总成绩：
                    </div>
                    <div class="my-row-r" style="height:auto;">
                        <span class="font-style" id="zcj">等待录入</span>
                        <a id="grade_html" href="javascript:;" name="none" class="a-text main-l" style="display: inline;">查看详情</a>
                    </div>

                </div>

                <!--老师们给出成绩展示-->
                <div class="clearfix tea-row">
                    <div id="is_show_zhongqi" class="disNone">
                        <span id="zqname" class="wd-nosub">中期考评成绩</span>
                        <span id="zqkp" class="somber">等待录入</span>
                    </div>
                    <div id="is_show_gufan" class="disNone">
                        <span id="gfname" class="wd-nosub">规范审查成绩</span>
                        <span id="gfsc" class="somber">等待录入</span>
                    </div>
                    <div id="is_show_zhidao" class="disNone">
                        <span id="zdname" class="wd-nosub">指导成绩</span>
                        <span id="zdjscj" class="somber">等待录入</span>
                    </div>
                    <div id="is_show_zhuanyefuze" class="disNone">
                        <span id="zyname" class="wd-nosub">评阅成绩</span>
                        <span id="zyfzr" class="somber">等待录入</span>
                    </div>
                    <div id="is_show_pingyuezhuanjia" class="disNone" style="margin-top:0;padding-top:0;border:none;">
                        <span id="pyname" class="wd-nosub">评阅专家成绩</span>
                        <span id="pyzj" class="somber">等待录入</span>
                    </div>
                    <div id="is_show_dabian" class="disNone">
                        <span id="dbname" class="wd-nosub">答辩成绩</span>
                        <span id="dbcj" class="somber">等待录入</span>
                    </div>
                    <div id="is_show_pingyueTow" class="disNone">
                        <span id="tow_pyname" class="wd-nosub">第二评阅成绩</span>
                        <span id="tow_pycj" class="somber">等待录入</span>
                    </div>
                    <div id="is_show_ktdb" class="disNone">
                        <span id="ktdb_name" class="wd-nosub">开题答辩成绩</span>
                        <span id="ktdb" class="somber">等待录入</span>
                    </div>
                    <div id="is_show_pscj" class="disNone">
                        <span id="pscj_name" class="wd-nosub">平时成绩</span>
                        <span id="pscj" class="somber"><i class="txt_red">等待录入</i></span>
                    </div>
                </div>
            </div>
        </div>
        <!--导出文档-->
        <div id="export_document">
            <div class="gxf_problem gxf_problem_detail">
                <div><h2><span></span>导出文档</h2></div>
            </div>
            <div class="margb">
                <div class="explain">
                    <p>您所在学校目前已配置的过程文档有：<span id="explain_type" style="font-weight:700;">任务书&nbsp;&nbsp;指导教师评阅意见书&nbsp;&nbsp;评阅专家评阅意见书&nbsp;&nbsp;指导记录&nbsp;&nbsp;答辩录入员评阅意见书&nbsp;&nbsp;</span> </p>
                    <div class="download_wechart_tips">
                        <div class="tips_left">
                            <img src="./weixindigg.jpg" alt="导出文档微信消息提示" title="点击放大" onclick="showWechartBox();">
                        </div>
                        <div class="tips_right">
                            <p>扫一扫关注微信，在导出任务处理完成后，系统将会按照您的设定给您发送提醒</p>
                            <p>导出文档的下载有效期是<span class="txt_red">96个小时（以处理完成时间开始计算）</span>，请在文档导出处理成功后及时下载；过期后需要重新生成导出文档后才能下载</p>
                        </div>
                    </div>
                </div>

                <div class="my-subject">
                    <div>
                        <span id="derive" href="#" class="radiusBtn">导出全部过程文档</span><span class="main-l">支持导出已配置的全部过程文档、提交的毕设论文、附件、有权限查看的检测报告单</span>
                    </div>

                    <div>
                        <span id="configuration" href="#" class="radiusBtn margt">导出已配置的文档</span><span class="main-l">支持选择某一种已配置的过程文档导出（配置导出模板的内容；若需要下载毕设论文、附件、有权限查看的报告单等，请使用“导出全部过程文档”功能）</span>
                    </div>
                    <!--导出已配置的文档的 弹框-->
                    
                    <div>
                        <span id="" href="#" class="radiusBtn margt" onclick="showOutputList()">下载已导出的文档</span><span class="main-l">选择导出文档后，需要等待系统后台进行导出，导出完成后点击“下载”可将导出的文档下载到本地</span>
                    </div>

                </div>

            </div>
        </div>

        <div style="width:0;height:0;overflow:hidden">
            <!-- 提示模板  -->
            
            
        </div>
        
    </div>
    <script type="text/javascript">
        var stuRefuse;// 是否允许学生拒绝指定课题
        var auditType = false;// 审核模式
        // 是否有权限修改和查看申请修改
        var isTrueApply = false;
        (function getPermission() {
            $.ajax({
                url: "../Handler/CommonHandler.ashx",
                data: { "action": "GetSystemSetData" },
                dataType: "json",
                async: false,
                type: "POST",
                success: function (data) {
                    if (data.isSuccess == true) {
                        if (data.rows[0]["申请教学秘书修改课题"] == 1 && data.rows[0]['是否关闭经申请修改'] == 0) {
                            isTrueApply = true;
                        }
                    }
                },
                error: function () {
                    console.log(err);
                }
            });
        })();
        $(document).ready(function () {
            $(".dictionary_1").html(SetDictionary(1));
            $(".dictionary_2").html(SetDictionary(2));
            $(".dictionary_3").html(SetDictionary(3));
            $(".dictionary_4").html(SetDictionary(4));
            $(".dictionary_5").html(SetDictionary(5));
            $(".dictionary_6").html(SetDictionary(6));
            $(".dictionary_7").html(SetDictionary(10));
            $(".dictionary_8").html(SetDictionary(11));
            $(".dictionary_9").html(SetDictionary(16));
            getSub();//指导记录的跳转
            getIsSchedule()//获取要显示的进度盒子
            GetRoleName();//取自定义的成绩名称
            getPreSelectState();//师生预选
            getData();//获取数据
            getLiveSettings()
            //getAnswer(); //获取我的答辩组情况
            getGrade();//获取我的成绩
            showPortion()//显示部分成绩
            GetExplain_type(); //获取说明的模板类型
        });
        function showWechartBox() {
            $("#wechartModel").dialog({ title: "提示" }).dialog('open').window('center');
        }
        //获取要显示的进度盒子
        function getIsSchedule() {
            $.ajax({
                url: "../Handler/PlanInfo.ashx?action=GetPlanFunModelsWithMenu",
                data: { iSCreat: 0 },
                type: 'post',
                dataType: 'json',
                success: function (data) {
                    if (data.isSuccess) {
                        var html = '';
                        var title;
                        var classStyle = 'plan-bgc-gray';
                        var classBor = 'plan-bor-gray';
                        var classFont = 'plan-font-gray';
                        var planText = '';
                        var arr = [];
                        $.each(data.rows, function (i, v) {
                            if (v["id"] == 0) { arr[0] = v; };
                            if (v["id"] == 8) { arr[1] = v; };
                            if (v["id"] == 9) { arr[2] = v; };
                            if (v["id"] == 1) { arr[3] = v; };
                            if (v["id"] == 11) { arr[4] = v; };
                            if (v["id"] == 2) { arr[5] = v; };
                            if (v["id"] == 4) { arr[6] = v; };
                            if (v["id"] == 5) { arr[7] = v; };
                            if (v["id"] == 6) { arr[8] = v; };
                            if (v["id"] == 12) { arr[9] = v; };
                            if (v["id"] == 3) { arr[10] = v; };
                            if (v["id"] == 7) { arr[11] = v; };
                            if (v["id"] == 10) { arr[12] = v; };
                            if (v["id"] == 13) { arr[13] = v; };
                        });
                        $.each(arr, function (i, v) {
                            if (v["type"] == "") { classStyle = 'plan-bgc-gray'; classBor = 'plan-bor-gray'; classFont = 'plan-font-gray'; planText = '未设置时间节点时间段范围' };
                            if (v["type"] == 1) { classStyle = 'plan-bgc-blue'; classBor = 'plan-bor-blue'; classFont = 'plan-font-blue'; planText = '当前时间尚未到达该节点时间段范围，请等待到开始时间后进行对应操作' };
                            if (v["type"] == 2) { classStyle = 'plan-bgc-green'; classBor = 'plan-bor-green'; classFont = 'plan-font-green'; planText = '当前时间已超过该节点时间段范围，不支持进行对应操作' };
                            if (v["type"] == 3) { classStyle = 'plan-bgc-yellow'; classBor = 'plan-bor-yellow'; classFont = 'plan-font-yellow'; planText = '当前时间正在该节点时间段范围内，请及时进行对应操作' };
                            if (v["id"] == 0) { title = '申报题目' };
                            if (v["id"] == 1) { title = ('提交' + SetDictionary(1)) };
                            if (v["id"] == 2) { title = ('提交' + SetDictionary(2)) };
                            if (v["id"] == 3) { title = ('提交' + SetDictionary(6)) };
                            if (v["id"] == 4) { title = ('提交' + SetDictionary(3)) };
                            if (v["id"] == 13) { title = ('提交' + SetDictionary(16)) };
                            if (v["id"] == 5) { title = ('提交' + SetDictionary(5)) };
                            if (v["id"] == 6) { title = ('提交' + SetDictionary(4)) };
                            if (v["id"] == 7) { title = '评审答辩' };
                            if (v["id"] == 8) { title = '选题' };
                            if (v["id"] == 9) { title = '提交任务书' };
                            if (v["id"] == 10) { title = '推优' };
                            if (v["id"] == 11) { title = ('提交' + SetDictionary(10)) };//初期检查
                            if (v["id"] == 12) { title = ('提交' + SetDictionary(11)) };//初稿
                            if (v["show"]) {
                                if (v["id"] != 3 && v["id"] != 4 && v["id"] != 13 && v["show"]) {
                                    var star = v["BeginTime"] == "" ? "未设置" : v["BeginTime"];
                                    var end = v["EndTime"] == "" ? "未设置" : v["EndTime"];
                                    html += '<div class="modules ' + classStyle + '" name="' + title + '" star="' + star + '" end="' + end + '" bor="' + classBor + '" color="' + classFont + '" planText="' + planText + '">' + title + '</div>';
                                };
                                //论文单独处理
                                if (v["id"] == 3 && v["checkIsTime"] == 1) {
                                    var number = '已设置' + v["checkNum"] + '次';
                                    html += '<div class="modules ' + classStyle + '" isAjax="lunwen" minMax="' + number + '" name="' + title + '"  bor="' + classBor + '" color="' + classFont + '" planText="' + planText + '">' + title + '</div>'
                                } else if (v["id"] == 3) {
                                    var star = v["BeginTime"] == "" ? "未设置" : v["BeginTime"];
                                    var end = v["EndTime"] == "" ? "未设置" : v["EndTime"];
                                    html += '<div class="modules ' + classStyle + '" name="' + title + '" star="' + star + '" end="' + end + '" bor="' + classBor + '" color="' + classFont + '" planText="' + planText + '">' + title + '</div>';
                                };
                                // 指导记录单独处理
                                if (v["id"] == 4 && v["logIsTime"] == 1) {
                                    var number = '';
                                    if (v["logIsMin"] == 1) { number = '最少需要提交' + v["logMinNum"] + '次指导记录' };
                                    if (v["logIsMax"] == 1) { number = '最多需要提交' + v["logMaxNum"] + '次指导记录' };
                                    if (v["logIsMax"] == 1 && v["logIsMin"] == 1) {// 准确的次数
                                        number = '已设置最少提交 ' + v["logMinNum"] + '次，最多提交' + v["logMaxNum"] + '次指导记录'
                                    };
                                    html += '<div class="modules ' + classStyle + '" isAjax="zhidao" leixing="4" minMax="' + number + '" name="' + title + '"  bor="' + classBor + '" color="' + classFont + '" planText="' + planText + '">' + title + '</div>';
                                } else if (v["id"] == 4) {
                                    var star = v["BeginTime"] == "" ? "未设置" : v["BeginTime"];
                                    var end = v["EndTime"] == "" ? "未设置" : v["EndTime"];
                                    html += '<div class="modules ' + classStyle + '" name="' + title + '" leixing="4" star="' + star + '" end="' + end + '" bor="' + classBor + '" color="' + classFont + '" planText="' + planText + '">' + title + '</div>';
                                };
                                // 写作记录单独处理
                                if (v["id"] == 13 && v["logIsTime"] == 1) {
                                    var number = '';
                                    if (v["logIsMin"] == 1) { number = '最少需要提交' + v["logMinNum"] + '次写作记录' };
                                    if (v["logIsMax"] == 1) { number = '最多需要提交' + v["logMaxNum"] + '次写作记录' };
                                    if (v["logIsMax"] == 1 && v["logIsMin"] == 1) {// 准确的次数
                                        number = '已设置最少提交 ' + v["logMinNum"] + '次，最多提交' + v["logMaxNum"] + '次写作记录'
                                    };
                                    html += '<div class="modules ' + classStyle + '" isAjax="xiezuo" leixing="13" minMax="' + number + '" name="' + title + '"  bor="' + classBor + '" color="' + classFont + '" planText="' + planText + '">' + title + '</div>';
                                } else if (v["id"] == 13) {
                                    var star = v["BeginTime"] == "" ? "未设置" : v["BeginTime"];
                                    var end = v["EndTime"] == "" ? "未设置" : v["EndTime"];
                                    html += '<div class="modules ' + classStyle + '" name="' + title + '" leixing="13" star="' + star + '" end="' + end + '" bor="' + classBor + '" color="' + classFont + '" planText="' + planText + '">' + title + '</div>';
                                };
                            };
                        })
                        $("#plan_box").html(html);
                        var tmp = true;
                        $(".modules").mouseover(function () {
                            $("#title_box").addClass($(this).attr('bor'))//边框颜色
                            $("#mark").addClass($(this).attr('color'))//星星颜色
                            $("#text_plan").text($(this).attr('planText'))// 进度文字
                            $("#topic").text($(this).attr('name'));//模块名称
                            //是否要请求指导
                            if ($(this).attr("leixing") == '4') {
                                $("#sub_role_type").show();//指导记录老师提交 提示显示
                            } else {
                                $("#sub_role_type").hide();//指导记录老师提交 提示显示
                            }
                            if ($(this).attr("isAjax") && $(this).attr("isAjax") == 'zhidao') {
                               
                                $("#nub_text").text($(this).attr('minMax'));
                                $("#multiple").show();//多次时间显示
                                if (tmp) {
                                    tmp = false;
                                    $.ajax({
                                        url: '../Handler/SystemSet.ashx?action=GetSystemTime&type=4',
                                        data: 'post',
                                        async: false,
                                        dataType: 'json',
                                        success: function (data) {
                                            if (data.isSuccess) {
                                                var html = ''
                                                $.each(data.rows, function (i, v) {
                                                    var s = i + 1;
                                                    html += ' <p> 第' + s + '次：开始时间：' + v['开始时间'] + ' <span class="margl">截止时间：' + v['结束时间'] + '</span></p >'
                                                })
                                                $("#single").hide();//固定时间隐藏
                                                $("#html_multiple").html(html)
                                                tmp = true;
                                            } else {
                                                console.log(data.message);
                                            };
                                        }
                                    });
                                };
                            } else if ($(this).attr("isAjax") && $(this).attr("isAjax") == 'xiezuo') {

                                $("#nub_text").text($(this).attr('minMax'));
                                $("#multiple").show();//多次时间显示
                                if (tmp) {
                                    tmp = false;
                                    $.ajax({
                                        url: '../Handler/SystemSet.ashx?action=GetSystemTime_WritingRecordCard&type=13',
                                        data: 'post',
                                        async: false,
                                        dataType: 'json',
                                        success: function (data) {
                                            if (data.isSuccess) {
                                                var html = ''
                                                $.each(data.rows, function (i, v) {
                                                    var s = i + 1;
                                                    html += ' <p> 第' + s + '次：开始时间：' + v['开始时间'] + ' <span class="margl">截止时间：' + v['结束时间'] + '</span></p >'
                                                })
                                                $("#single").hide();//固定时间隐藏
                                                $("#html_multiple").html(html)
                                                tmp = true;
                                            } else {
                                                console.log(data.message);
                                            };
                                        }
                                    });
                                };
                            }else if ($(this).attr("isAjax") && $(this).attr("isAjax") == 'lunwen') {
                                $("#single").hide(); //固定时间隐藏
                                $("#nub_text").text($(this).attr('minMax'))
                                $("#multiple").show();
                                if (tmp) {
                                    tmp = false;
                                    $.ajax({
                                        url: '../Handler/SystemSet.ashx?action=GetCheckCount',
                                        data: 'post',
                                        async: false,
                                        dataType: 'json',
                                        success: function (data) {
                                            if (data.isSuccess) {
                                                var html = ''
                                                $.each(data.rows, function (i, v) {
                                                    var s = i + 1;
                                                    html += ' <p> 第' + s + '次：开始时间：' + v['开始时间'] + ' <span class="margl">截止时间：' + v['结束时间'] + '</span></p >'
                                                })
                                                $("#html_multiple").html(html)
                                                tmp = true;
                                            } else {
                                                console.log(data.message);
                                            };
                                        }
                                    });
                                };
                            } else {
                                $("#single").show();
                                $("#multiple").hide();
                                $("#star").text($(this).attr('star'));//开始时间
                                $("#end").text($(this).attr('end'));//结束时间
                            };
                            $("#title_box").show();
                        })
                        $(".modules").mouseout(function () { // 鼠标移出
                            $("#title_box").hide()
                            $("#title_box").removeClass($("#title_box").attr('class'))//边框颜色
                            $("#mark").removeClass($("#mark").attr('class'))//星星颜色
                            $("#topic").text('正在加载');//模块名称
                            $("#text_plan").text('正在加载')// 进度文字
                            $("#star").text($(this).attr('456'));//开始时间
                            $("#end").text($(this).attr('456'));//结束时间
                        })
                    };
                },
                error: function (err) {
                    console.log(err);
                }
            });
        };
        //自定义成绩名称方法
        function GetRoleName() {
            var rowsrole = GetGrade();
            //成绩自定义名称
            $("#zdname").text(GetGradeNames(1, rowsrole));//指导成绩
            $("#zyname").text(GetGradeNames(2, rowsrole));//专业负责人成绩
            $("#pyname").text(GetGradeNames(3, rowsrole));//评阅专家成绩
            $("#dbname").text(GetGradeNames(4, rowsrole));//答辩成绩
            $("#zqname").text(GetGradeNames(6, rowsrole));//中期成绩
            $("#gfname").text(GetGradeNames(7, rowsrole));//规范成绩
            $("#tow_pyname").text(GetGradeNames(8, rowsrole));//第二评阅专家成绩
            $("#ktdb_name").text(GetGradeNames(9, rowsrole));//平时成绩
            $("#pscj_name").text(GetGradeNames(10, rowsrole));//平时成绩

        };
        //选题分析按钮
        $("#xuantifenxi").off().on('click', function () {
            openframe('选题分析', '../Project/AnalysisOfTopics.html', true);
        });
        //学生选题跳转
        $("#teaprojectLink").off().on('click', function () {
            openframe('学生选题', '../Project/StuChoiceProjectList.html', true);
        });
        //申报题目跳转
        $("#stuprojectLink").off().on('click', function () {
            openframe('学生申报题目', '../Project/StuProjectList.html', true);
        });
        //查看任务书跳转
        $("#task").off().on('click', function () {
            openframe('查看任务书', '../Task/Add.html', true);
        });
        //外文翻译跳转
        $("#translate_a").off().on('click', function () {
            openframe(('提交' + SetDictionary(4)), '../Student/SubmitForeignLiterature.html', true);
        });
        //开题报告跳转
        $("#open_topic_a").off().on('click', function () {
            openframe(('提交' + SetDictionary(1)), '../Student/SubmitOpenReport.html', true);
        });
        //初期检查跳转
        $("#early_a").off().on('click', function () {
            openframe(('提交' + SetDictionary(10)), '../Student/SubmitEarlyCheck.html', true);
        });
        //写作记录跳转
        $("#WritingRecord_a").off().on('click', function () {
            openframe(('提交' + SetDictionary(16)), '../Student/SubmitWritingRecordCard.html', true);
        });
        //指导记录跳转
        function getSub() {
            $.ajax({
                url: '../Handler/SystemSet.ashx?action=GetSystemList',
                type: 'post',
                async: false,
                dataType: 'json',
                success: function (data) {
                    if (data.isSuccess) {
                        stuRefuse = data.rows[0]["是否允许学生拒绝指定课题"];//1的时候
                    };
                    if (data.isSuccess && data.rows[0]['指导记录提交设置'] == 2) {//教师提交
                        $("#sub_role_type").text("当前设置由指导教师提交指导记录，学生仅支持查看");
                        $("#adviser_record_a").off().on('click', function () {
                            openframe(('查看' + SetDictionary(3)), '../Student/ProjectLogHistoryRecord.html', true);
                        });
                    } else {//学生提交
                        $("#adviser_record_a").off().on('click', function () {
                            openframe(('提交' + SetDictionary(3)), '../Student/SubmitGuideRecord.html', true);
                        });
                    };
                }
            });
        };
        //中期检查跳转
        $("#centre_report_a").off().on('click', function () {
            openframe(('提交' + SetDictionary(2)), '../Student/SubmitMiddleReport.html', true);
        });
        //文献综述跳转
        $("#literature_a").off().on('click', function () {
            openframe(('提交' + SetDictionary(5)), '../Student/SubmitLiteratureReview.html', true);
        });
        //毕业设计（论文）跳转
        $("#paper_a").off().on('click', function () {
            openframe(('提交' + SetDictionary(6)), '../Student/StuThesisList.html', true);
        });
        //初稿跳转
        $("#Draft_a").off().on('click', function () {
            openframe(('提交' + SetDictionary(11)), '../Student/StuPaperDraftList.html', true);
        });
        //获取数据
        function getData() {
            $.ajax({
                url: "../Handler/StuHome.ashx?action=BindStuInfo",
                type: "post",
                dataType: "json",
                async: false,
                success: function (data) {
                    if (data.isSuccess) {
                        if (!data.rows[0]["审核时间"]) {// 审核时间为空
                            if (data.rows[0]["课题模式"] == 2 || data.rows[0]["课题模式"] == 4) {// 并且模式等于2或4
                                //auditType = true;
                                if (stuRefuse == 1) {
                                    $("#refuse").show();// 拒绝课题显示
                                };
                            };
                        };
                        //题目显示样式
                        if (data.rows[0]["显示课题详情"] == 1) {
                            $("[name='none-one']").show();//题目 老师显示
                        } else if (data.rows[0]["显示课题详情"] != 1) {
                            $("[name='none-tow']").show();//题目数字显示
                        };
                        //论文行是否显示提示
                        if (data.rows[0]["最终版权限"] == 1) {
                            $("#last").show();
                        };
                        if (data.rows[0]["超权限权限"] == 1) {
                            $("#overrun").show();
                        };
                        var ktbh = data.rows[0]["课题编号"];
                        //每行是否显示允许修改提示文字
                        if (data.rows[0]["外文译文允许修改"] == 1) {
                            $("#yunxuxiugai_one").show();
                        };
                        if (data.rows[0]["开题报告允许修改"] == 1) {
                            $("#yunxuxiugai_tow").show();
                        };
                        if (data.rows[0]["指导记录允许修改"] == 1) {
                            $("#yunxuxiugai_three").show();
                        };
                        if (data.rows[0]["中期报告允许修改"] == 1) {
                            $("#yunxuxiugai_four").show();
                        };
                        if (data.rows[0]["文献综述允许修改"] == 1) {
                            $("#yunxuxiugai_five").show();
                        };
                        if (data.rows[0]["初期检查允许修改"] == 1) {
                            $("#yunxuxiugai_six").show();
                        };
                        // 申请修改题目/查看修改申请
                        if (isTrueApply) {
                            if (data.rows[0]["审核状态"] == 1 && data.rows[0]["修改申请"] == 0) {
                                $("#UpdateProject").html("申请修改题目");
                                $("#UpdateProject").show();
                            };
                        };

                        if (data.rows[0]["审核状态"] == 1 && !checkValIsUndefinedOrNull(data.rows[0]["修改申请审核"])) {
                            $("#UpdateProject").html("查看修改申请");
                            $("#UpdateProject").show();
                        };

                        $("#UpdateProject").on("click", function () {
                            openframe('申请修改题目记录', '../Project/ApplyForUpdateProList.html?id=' + ktbh, false);
                        });
                        // 拒绝课题
                        $("#refuse").click(function () {
                            $('#delmessagebox').html("你确定要拒绝课题吗？").dialog({
                                title: '拒绝课题',
                                buttons: [
                                    {
                                        text: '确定',
                                        handler: function () {
                                            $.ajax({
                                                url: "../Handler/StuHome.ashx?action=RefuseTeaProject&projectID=" + ktbh,
                                                dataType: 'json',
                                                type: 'post',
                                                success: function (data) {
                                                    $("#delmessagebox").dialog("close");
                                                    if (data.isSuccess) {
                                                        window.location.reload();
                                                    };
                                                    myMessage(data.message);
                                                }
                                            });
                                        }
                                    }, {
                                        text: '取消',
                                        handler: function () {
                                            $("#delmessagebox").dialog("close");
                                        }
                                    }
                                ]
                            }).dialog("open").window('center');
                        });
                        //任务书是否显示
                        if (data.rows[0]["是否显示任务书"] != -1) {
                            $("#TaskIsShow").show();
                        };
                        $("#subject_nuber").text(data.rows[0]["课题数量"])//学生题目数量
                        if (data.rows[0]["课题数量"] == 0) {
                            $("#aProject_one,#shzt,#TaskIsShow").hide();//链接，审核状态行，任务书行隐藏掉
                        }

                        if (data.rows[0]["课题题目"] == null) {
                            $("#task_topic").html("<span style='color:#c5001c;'>您还没有申报或者选择题目</span>")
                        } else {
                            $("#task_topic").text(retrieveUnequa(data.rows[0]["课题题目"]) + '【' + getprojetype(data.rows[0]["课题模式"]) + '】')//题目
                        };

                        if (data.rows[0]["显示课题详情"] == 1) {
                            if (data.rows[0]["是否教师确认"] == 1) {
                                $("#audit_state").html("<span class='" + getAuditCss(data.rows[0]["审核状态"]) + "'>" + getAuditStateText(data.rows[0]["审核状态"], 6) + "，</span>" + getteacher(data.rows[0]["教师确认状态"]))//审核状态
                            } else {
                                if (data.rows[0]["是否草稿"] && data.rows[0]["是否草稿"] == 1) {
                                    $("#audit_state").html("草稿")//审核状态
                                } else {
                                    $("#audit_state").html("<span class='" + getAuditCss(data.rows[0]["审核状态"]) + "'>" + getAuditStateText(data.rows[0]["审核状态"], 6) + "</span>")//审核状态
                                }
                            };
                        }

                        if (data.rows[0]["显示课题详情"] == 0) {
                            $("#audit_state").html("<span class='txt_yellow'>等待指导教师确认</span>")//审核状态
                        }
                        //指导教师信息
                        if (data.rows[0]["教师姓名"] == null) {
                            $("#teacher_name").html()
                        } else {
                            $("#teacher_name").html(data.rows[0]["教师姓名"] + '&nbsp;(' + data.rows[0]["教师编号"] + ')&nbsp;/&nbsp;' + data.rows[0]["教师学院名称"] + '&nbsp;/&nbsp;' + data.rows[0]["教师职称"]);
                            $("#tel_mail").html(data.rows[0]["教师电话"]) //+ '&nbsp;/&nbsp;' + data.rows[0]["教师邮箱"]); //联系方式

                        };

                        //开题报告
                        if (data.rows[0]["是否显示开题报告"] != -1) {
                            $("#proposal").show();
                        };
                        if (data.rows[0]['是否开题报告草稿'] != 1) {
                            $("#open_topic").html(getsubcss(data.rows[0]["是否提交开题报告"]));
                            if (data.rows[0]["是否提交开题报告"] == 1) {
                                var shzttext = "<span class='" + getAuditCss(data.rows[0]["开题报告审核"]) + ' margl' + "'>" + getAuditStateText(data.rows[0]["开题报告审核"], 1) + "</span>";
                                $("#open_topic").append(shzttext);
                            };
                        } else {
                            $("#open_topic").html('<span class="wd-nosub">草稿</span>');
                        };

                        //初期检查
                        if (data.rows[0]["是否显示初期检查"] != -1) {
                            $("#earlycheck").show();

                        };
                        if (data.rows[0]['是否初期检查草稿'] != 1) {
                            $("#early").html(getsubcss(data.rows[0]["是否提交初期检查"]));
                            if (data.rows[0]["是否提交初期检查"] == 1) {
                                var shzttext = "<span class='" + getAuditCss(data.rows[0]["初期检查审核"]) + ' margl' + "'>" + getAuditStateText(data.rows[0]["初期检查审核"], 26) + "</span>";
                                $("#early").append(shzttext);
                            };
                        } else {
                            $("#early").html('<span class="wd-nosub">草稿</span>');
                        };

                        //中期报告
                        if (data.rows[0]["是否显示中期报告"] != -1) {
                            $("#metaphase").show();

                        };
                        $("#centre_report").html(getsubcss(data.rows[0]["是否提交中期报告"]));
                        if (data.rows[0]["是否提交中期报告"] == 1) {
                            var shzttext = "<span class='" + getAuditCss(data.rows[0]["中期报告审核"]) + ' margl' + "'>" + getAuditStateText(data.rows[0]["中期报告审核"], 5) + "</span>";
                            $("#centre_report").append(shzttext);
                        };

                        //写作记录
                        if (data.rows[0]["是否显示写作记录"] != -1) {
                            $("#Writing").show();

                        };
                        $("#WritingRecord").html(getsubcss(data.rows[0]["是否提交写作记录"]));
                        if (data.rows[0]["是否提交写作记录"] == 1) {
                            var shzttext = "<span class='" + getAuditCss(data.rows[0]["写作记录审核"]) + ' margl' + "'>" + getAuditStateText(data.rows[0]["写作记录审核"], 29) + "</span>";
                            $("#WritingRecord").append(shzttext);
                        };

                        //指导记录
                        if (data.rows[0]["是否显示指导记录"] != -1) {
                            $("#adviser").show();

                        };
                        $("#adviser_record").html(getsubcss(data.rows[0]["是否提交指导记录"]));
                        if (data.rows[0]["是否提交指导记录"] == 1) {
                            var shzttext = "<span class='" + getAuditCss(data.rows[0]["指导记录审核"]) + ' margl' + "'>" + getAuditStateText(data.rows[0]["指导记录审核"], 3) + "</span>";
                            $("#adviser_record").append(shzttext);
                        };

                        //外文翻译
                        if (data.rows[0]["是否显示外文译文"] != -1) {
                            $("#foreign_language").show();


                        };
                        $("#translate").html(getsubcss(data.rows[0]["是否提交外文译文"]));
                        if (data.rows[0]["是否提交外文译文"] == 1) {
                            var shzttext = "<span class='" + getAuditCss(data.rows[0]["外文译文审核"]) + ' margl' + "'>" + getAuditStateText(data.rows[0]["外文译文审核"], 2) + "</span>";
                            $("#translate").append(shzttext);
                        };

                        //文献综述
                        if (data.rows[0]["是否显示文献综述"] != -1) {

                            $("#literature_summarize").show();
                        };
                        $("#literature").html(getsubcss(data.rows[0]["是否提交文献综述"]));
                        if (data.rows[0]["是否提交文献综述"] == 1) {
                            var shzttext = "<span class='" + getAuditCss(data.rows[0]["文献综述审核"]) + ' margl' + "'>" + getAuditStateText(data.rows[0]["文献综述审核"], 10) + "</span>";
                            $("#literature").append(shzttext);
                        };
                        //初稿
                        if (data.rows[0]["是否显示初稿"] != -1) {
                            $("#paperDraft").show();        //已经在行内给自己一行加上 底线
                        };
                        $("#Draft").html(getsubcss(data.rows[0]["是否提交初稿"]));
                        if (data.rows[0]["是否提交初稿"] == 1) {
                            var shzttext = "<span class='" + getAuditCss(data.rows[0]["初稿审核"]) + ' margl' + "'>" + getAuditStateText(data.rows[0]["初稿审核"], 27) + "</span>";
                            $("#Draft").append(shzttext);
                        };
                        //毕业设计（论文）
                        if (data.rows[0]["是否显示论文"] != -1) {
                            $("#thesis").show();        //已经在行内给自己一行加上 底线
                        };
                        $("#paper").html(getsubcss(data.rows[0]["是否提交论文"]));
                        if (data.rows[0]["是否提交论文"] == 1) {
                            var shzttext = "<span class='" + getAuditCss(data.rows[0]["论文审核"]) + ' margl' + "'>" + getAuditStateText(data.rows[0]["论文审核"], 4) + "</span>";
                            $("#paper").append(shzttext);
                        };

                        //显示题目数量的链接
                        $("#aProject_one").off().on('click', function () {
                            openframe('学生选题', '../Project/StuChoiceProjectList.html', false);
                        });
                        //显示题目名称时的链接
                        if (ktbh) {
                            //查看题目跳转 需要带题目编号过去。 题目编号不为空代表有题目
                            if (data.rows[0]["是否草稿"] && data.rows[0]["是否草稿"] == 1) {
                                $("#aProject").text("草稿");
                            } else {
                                $("#aProject").text("查看详情");
                            }
                            $("#aProject").off().on('click', function () {
                                if (data.rows[0]["是否草稿"] && data.rows[0]["是否草稿"] == 1) {
                                    openframe('录入题目', 'Project/Update.html?id=' + ktbh + '&ProjectFlag=0', false);
                                    //openframe('题目详细信息', '../Project/Details.html?id=' + ktbh, false);
                                } else {
                                    openframe('题目详细信息', '../Project/Details.html?id=' + ktbh, false);
                                }
                            });
                        } else {
                            $("#aProject").hide();
                        }

                        if (data.rows[0]["申报课题模式"] == '2')//学生提交题目
                        {
                            $("#stuprojectLink").show();
                            $("#teaprojectLink").hide();
                        };
                        if (data.rows[0]["申报课题模式"] == '1')//教师提交题目
                        {
                            $("#stuprojectLink").hide();
                            $("#teaprojectLink").show();
                        };
                        if (data.rows[0]["申报课题模式"] == '0')//学生 教师 提交题目
                        {
                            $("#stuprojectLink").show();
                            $("#teaprojectLink").show();
                        };
                    };
                },
                error: function (err) {
                    console.log(err);
                }
            });
        };

        //答辩安排
        $("#anpai").off().on('click', function () {
            openframe('查看答辩安排', '../Answer/ReplyArrange.html', true);
        });
        $("#jilu").off().on('click', function () {
            openframe('查看答辩记录', '../Answer/SubReplyRecord.html', true);
        });
        $("#open_one").off().on('click', function () {
            openframe('查看开题答辩安排', '../OpenAnswer/OpenAnswerArrange.html', true);
        });
        $("#open_tow").off().on('click', function () {
            openframe('查看开题答辩结论', '../OpenAnswer/OpenAnswerRecordHistory.html', true);
        });

        function getLiveSettings() {
            $.ajax({
                url: "../Handler/Answer.ashx",
                type: "post",
                dataType: "json",
                data: {
                    action: "GetLiveSettings"
                },
                success: function (data) {
                    if (data && data.isSuccess && data.rows && data.rows.length > 0) {
                        if (data.rows[0]['State'] == 1) {
                            getAnswer(true, data.rows[0]['MaxTime']);
                        } else {
                            getAnswer(false)
                        }
                    } else {
                        getAnswer(false)
                    }
                },
                error: function (err) {
                    getAnswer(false)
                    console.log(err);
                }
            });
        }

        //获取我的答辩组
        function getAnswer(isLive, maxTime) {
            $.ajax({
                url: "../Handler/Answer.ashx",
                data: {
                    action: "GetStuHomeAnswerInfo"
                },
                type: "post",
                dataType: "json",
                success: function (data) {
                    if (data && data.isSuccess && data.rows && data.rows.length > 0) {
                        //开题答辩
                        var QRLinkArr = [];
                        if (data.rows[0]["启用开题答辩"] == 1) {
                            $("#open_reply").show();
                            if (data.rows[0]['是否已安排开题答辩'] == 1) {
                                $("#openRreply_text").text("你已安排开题答辩");
                                $("#open_btn_box").show();
                                if (isLive) {
                                    var openLivehtml = '<div class="my-row-l"> </div>'
                                        + '<div class="my-row-r clearfix answer" style="height:auto;">'
                                    if (checkValIsUndefinedOrNull(data.rows[0]['OpenAnswerLiveUrl'])) {
                                        openLivehtml += '已开启直播答辩功能（您尚未创建直播答辩）'
                                        openLivehtml += ' <a class="a-text mgL" href="javascript:;" onclick="createLive(' + data.rows[0]['SID'] + ',' + data.rows[0]['课题编号'] + ',\'' + data.rows[0]["开题答辩日期"] + '\',' + (maxTime || -1) + ',' + data.rows[0]['开题答辩组编号'] + ')">创建直播答辩</a>';
                                    } else {
                                        openLivehtml += "已开启直播答辩功能"
                                        if (!checkValIsUndefinedOrNull(data.rows[0]['OpenAnswerLiveId']) && +(new Date()) < new Date(data.rows[0]['OpenAnswerLiveBeginTime'].replace(new RegExp("-", "gm"), "/")).getTime()) {
                                            openLivehtml += "<a class='listA mgL'  href='javascript:;' onclick='createLive(" + data.rows[0]['SID'] + ", "
                                                + data.rows[0]['课题编号'] + ",\"" + data.rows[0]["开题答辩日期"] + "\"," + (maxTime || -1) + "," + data.rows[0]['开题答辩组编号'] + "," + data.rows[0]['OpenAnswerLiveId'] + ",\"" + data.rows[0]['OpenAnswerLiveBeginTime'] + "\",\"" + data.rows[0]['OpenAnswerLiveEndTime'] + "\");'>修改</a>";
                                        }
                                        openLivehtml += "（您已创建直播答辩，直播地址："
                                        openLivehtml += '<span class="QRcodeMin mgL QR_' + QRLinkArr.length + '"><span class="QRcodeMax"><span class="text">扫一扫打开</span></span></span>';
                                        openLivehtml += "<span style='display:inline-block; vertical-align: bottom; margin-left: 10px;'><a class='listA'  href='" + data.rows[0]['OpenAnswerLiveUrl'] + "' target='_blank'>" + data.rows[0]['OpenAnswerLiveUrl'] + "</a>" + "）";
                                        openLivehtml += '<br />直播答辩完成后（本直播答辩结束时间：' + data.rows[0]['直播结束时间'] + '），点击对应直播地址可查看回放</span>';
                                        QRLinkArr.push(data.rows[0]['OpenAnswerLiveUrl'])
                                    }
                                    openLivehtml += '</div>';
                                    $("#open_reply").append(openLivehtml);
                                }
                            } else {
                                $("#openRreply_text").text("您还未安排开题答辩");
                            };
                        };
                        //答辩组
                        if (data.rows[0]['答辩次序'] <= 0) {
                            $("#answer_number").text("您还未安排答辩");
                            $('#anpai,#jilu').hide()
                        } else {
                            var AnswerQRLinkArr = [];
                            $('#anpai,#jilu').show()
                            $("#answer_number").text("已安排第" + data.rows[0]['答辩次序'] + "次答辩");
                            if (isLive) {
                                var answerLivehtml = '<div class="my-row-l"> </div>'
                                    + '<div class="my-row-r clearfix answer" style="height:auto;">';
                                if (checkValIsUndefinedOrNull(data.rows[0]['LiveUrl'])) {
                                    answerLivehtml += '已开启直播答辩功能（您尚未创建直播答辩）'
                                    answerLivehtml += ' <a class="a-text mgL" href="javascript:;" onclick="createLive(' + data.rows[0]['SID'] + ',' + data.rows[0]['课题编号'] + ',\'' + data.rows[0]["答辩日期"] + '\',' + (maxTime || -1) + ',' + data.rows[0]['答辩组编号'] + ')">创建直播答辩</a>';
                                } else {
                                    answerLivehtml += "已开启直播答辩功能"
                                    if (!checkValIsUndefinedOrNull(data.rows[0]['直播ID']) && +(new Date()) < new Date(data.rows[0]['直播开始时间'].replace(new RegExp("-", "gm"), "/")).getTime()) {
                                            answerLivehtml += "<a class='listA mgL'  href='javascript:;' onclick='createLive(" + data.rows[0]['SID'] + ", "
                                                + data.rows[0]['课题编号'] + ",\"" + data.rows[0]["答辩日期"] + "\"," + (maxTime || -1) + "," + data.rows[0]['答辩组编号'] + "," + data.rows[0]['直播ID'] + ",\"" + data.rows[0]['直播开始时间'] + "\",\"" + data.rows[0]['直播结束时间'] + "\");'>修改</a>";
                                        }
                                    answerLivehtml += "（您已创建直播答辩，直播地址："
                                    answerLivehtml += '<span class="QRcodeMin mgL QR_' + QRLinkArr.length + '"><span class="QRcodeMax"><span class="text">扫一扫打开</span></span></span>';
                                    answerLivehtml += "<span style='display:inline-block; vertical-align: bottom; margin-left: 10px;'><a class='listA'  href='" + data.rows[0]['LiveUrl'] + "' target='_blank'>" + data.rows[0]['LiveUrl'] + "</a>" + "）";
                                    answerLivehtml += '<br />直播答辩完成后（本直播答辩结束时间：' + data.rows[0]['直播结束时间'] + '），点击对应直播地址可查看回放</span>';
                                    QRLinkArr.push(data.rows[0]['LiveUrl'])
                                }
                                answerLivehtml += '</div>';
                                $("#answer_reply").append(answerLivehtml);
                            }
                        };
                        LinkBecomesQRcode(QRLinkArr);
                    }
                },
                error: function (err) {
                    console.log(err);
                }
            });
        };

        $("#my_team").on("mouseover", ".QRcodeMin", function () {
            $(this).find(".QRcodeMax").show();           
        }).on("mouseout", ".QRcodeMin", function () {
            $(this).find(".QRcodeMax").hide();
        })

        // url转换二维码
        function LinkBecomesQRcode(arr) {
            if (checkValIsUndefinedOrNull(arr) || arr.length <= 0) {
                return false;
            } else {
                $.each(arr, function (i, v) {
                    if (!checkValIsUndefinedOrNull(v)) {
                        $(".QRcodeMin.QR_" + i).qrcode({
                            render: "canvas",
                            width: 40,
                            height: 40,
                            text: v
                        });
                        $(".QRcodeMin.QR_" + i + ">.QRcodeMax").qrcode({
                            render: "canvas",
                            width: 100,
                            height: 100,
                            text: v
                        });
                    }  
                });
            }
        };

        function createLive(sid, proID, beginTime, maxTime, groupID, id, liveBtime, liveEtime) {
            notSelectedBeforeNowData('TimeBegin')
            notSelectedBeforeNowData('TimeEnd')

            $("#tips").html("您所在答辩组的答辩开始时间为：" + beginTime + (maxTime > 0 ? ("，根据学校的要求您答辩直播时间不能超过" + maxTime + "分钟") : "") + "。");
            if (id > 0) {
                $("#TimeBegin").datetimebox("setValue", liveBtime);
                $("#TimeEnd").datetimebox("setValue", liveEtime);
            }

            $("#createLiveBox").dialog({
                title: '创建直播',
                buttons: [
                    {
                        text: '确定',
                        handler: function () {
                            var beginTime = $("#TimeBegin").datetimebox("getValue")
                            var endTime = $("#TimeEnd").datetimebox("getValue")
                            if (checkValIsUndefinedOrNull(beginTime)) {
                                myMessage("直播开始时间不能为空，请重新输入");
                                return false
                            }
                            if (checkValIsUndefinedOrNull(endTime)) {
                                myMessage("直播结束时间不能为空，请重新输入");
                                return false
                            }
                            beginTime = new Date(beginTime.replace(new RegExp("-", "gm"), "/")).getTime();
                            endTime = new Date(endTime.replace(new RegExp("-", "gm"), "/")).getTime();
                            if (endTime < beginTime) {
                                myMessage("直播结束时间不能小于开始时间");
                                return false
                            }
                            if (endTime - beginTime > maxTime * 60 * 1000) {
                                myMessage("直播时长不能超过" + maxTime + "分钟，请重新选择");
                                return false
                            }
                            $.ajax({
                                url: "../Handler/Answer.ashx",
                                type: "post",
                                dataType: "json",
                                data: {
                                    action: "CreateLive",
                                    agId: groupID,
                                    sid: sid,
                                    projectId: proID,
                                    beginTime: $("#TimeBegin").datetimebox("getValue"),
                                    endTime: $("#TimeEnd").datetimebox("getValue"),
                                    liveId: id > 0 ? id : ''  
                                },
                                success: function (data) {
                                    if (data && data.isSuccess) {
                                        refreshTab2(getCurrentTab());//刷新当前页
                                    } else {
                                        myMessage(data.message || '创建失败')
                                    }
                                },
                                error: function (err) {
                                    console.log(err);
                                }
                            });
                        }
                    },
                    {
                        text: '取消',
                        handler: function () {
                            $("#createLiveBox").dialog("close");
                        }
                    }
                ]
            }).dialog('open').window('center');
        };

        //获取我的成绩
        //显示哪几种成绩
        function showPortion() {
            $.ajax({
                url: "../Handler/SystemSet.ashx?action=GetShoolSystemSetList",
                type: 'post',
                dataType: 'json',
                success: function (data) {
                    if (data.isSuccess) {
                        if (data.rows[0]['学生查看成绩'] == 1) {
                            return
                        } else if (data.rows[0]['学生查看成绩'] == 2) {
                            $("#my_grade,#nav_btn").show();
                        } else if (data.rows[0]['学生查看成绩'] == 0) {
                            $("#my_grade,#nav_btn").show();
                            GetHideList();//获取各分成绩是否显示
                        };
                    }
                }
            });
        }
        //获取各分成绩是否显示
        function GetHideList() {
            $.ajax({
                url: "../Handler/ReviewHandler.ashx",
                type: "post",
                data: {
                    action: 'GetReviewColumn'
                },
                dataType: "json",
                success: function (data) {
                    if (data.isSuccess) {
                        if (data.dataList[0]["不显示第二评阅成绩"] == 1) {
                            $("#is_show_pingyueTow").show()
                        };
                        if (data.dataList[0]["不显示规范审查成绩"] == 1) {
                            $("#is_show_gufan").show()
                        };
                        if (data.dataList[0]["不显示中期考评成绩"] == 1) {
                            $("#is_show_zhongqi").show();
                        };
                        if (data.dataList[0]["不显示答辩成绩"] == 1) {
                            $("#is_show_dabian").show();
                        };
                        if (data.dataList[0]["不显示评阅专家成绩"] == 1) {
                            $("#is_show_pingyuezhuanjia").show();
                        };
                        if (data.dataList[0]["不显示专业负责人评阅成绩"] == 1) {
                            $("#is_show_zhuanyefuze").show();
                        };
                        if (data.dataList[0]["不显示指导成绩"] == 1) {
                            $("#is_show_zhidao").show();
                        };
                        if (data.dataList[0]["不显示开题答辩成绩"] == 1) {
                            $("#is_show_ktdb").show();
                        };
                        if (data.dataList[0]["不显示平时成绩"] == 1) {
                            $("#is_show_pscj").show();
                        };

                    };
                }
            });
        };
        function getGrade() {
            $.ajax({
                url: "../Handler/StudentList.ashx",
                data: {
                    action: "GetStuScore"
                },
                type: "post",
                dataType: "json",
                success: function (data) {
                    if (data.isSuccess) {
                        $("#zcj").text(data.rows[0]["总成绩txt"] || "尚未总成绩");
                        if (data.rows[0]["中期考评成绩txt"] < 60) {
                            $("#zqkp").html('<i class="txt_red">' + data.rows[0]["中期考评成绩txt"] + '</i>');
                        } else {
                            $("#zqkp").text(data.rows[0]["中期考评成绩txt"]);
                        };

                        if (data.rows[0]["规范审查成绩txt"] < 60) {
                            $("#gfsc").html('<i class="txt_red">' + data.rows[0]["规范审查成绩txt"] + '</i>');
                        } else {
                            $("#gfsc").text(data.rows[0]["规范审查成绩txt"]);
                        };

                        if (data.rows[0]["指导成绩txt"] < 60) {
                            $("#zdjscj").html('<i class="txt_red">' + data.rows[0]["指导成绩txt"] + '</i>');
                        } else {
                            $("#zdjscj").text(data.rows[0]["指导成绩txt"]);
                        };

                        if (data.rows[0]["评阅成绩txt"] < 60) {
                            $("#zyfzr").html('<i class="txt_red">' + data.rows[0]["评阅成绩txt"] + '</i>');
                        } else {
                            $("#zyfzr").text(data.rows[0]["评阅成绩txt"]);
                        };

                        if (data.rows[0]["评阅专家成绩txt"] < 60) {
                            $("#pyzj").html('<i class="txt_red">' + data.rows[0]["评阅专家成绩txt"] + '</i>');
                        } else {
                            $("#pyzj").text(data.rows[0]["评阅专家成绩txt"]);
                        };

                        if (data.rows[0]["是否审核答辩成绩"] == '1') {
                            if (checkValIsUndefinedOrNull(data.rows[0]["答辩成绩审核状态"]) || data.rows[0]["答辩成绩审核状态"] == '1' || data.rows[0]["答辩成绩审核状态"] == 1001 || data.rows[0]["答辩成绩审核状态"] == -1) {
                                if (data.rows[0]["答辩成绩txt"] < 60) {
                                    $("#dbcj").html('<i class="txt_red">' + data.rows[0]["答辩成绩txt"] + '</i>');
                                } else {
                                    $("#dbcj").html(data.rows[0]["答辩成绩txt"]);
                                }
                            } else {
                                if (data.rows[0]["答辩成绩txt"] < 60) {
                                    $("#dbcj").html('<i class="txt_red">' + data.rows[0]["答辩成绩txt"] + '</i>'
                                        + '<i class="answerScoreMessage" onclick="myMessage(\'因您所在学校当前配置了答辩成绩需要审核，您有一个新的答辩成绩正在等待审核中。'
                                        + '当前显示的答辩成绩可能不是您的最终答辩成绩，系统将在审核环节完成后，根据实际审核情况显示\');"></i>');

                                } else {
                                    $("#dbcj").html(data.rows[0]["答辩成绩txt"]
                                        + '<i class="answerScoreMessage" onclick="myMessage(\'因您所在学校当前配置了答辩成绩需要审核，您有一个新的答辩成绩正在等待审核中。'
                                        + '当前显示的答辩成绩可能不是您的最终答辩成绩，系统将在审核环节完成后，根据实际审核情况显示\');"></i>');
                                }
                            }
                        } else {
                            if (data.rows[0]["答辩成绩txt"] < 60) {
                                $("#dbcj").html('<i class="txt_red">' + data.rows[0]["答辩成绩txt"] + '</i>');
                            } else {
                                $("#dbcj").html(data.rows[0]["答辩成绩txt"]);
                            }
                        }

                        if (data.rows[0]["第二评阅成绩txt"] < 60) {
                            $("#tow_pycj").html('<i class="txt_red">' + data.rows[0]["第二评阅成绩txt"] + '</i>');
                        } else {
                            $("#tow_pycj").text(data.rows[0]["第二评阅成绩txt"]);
                        };
                        if (data.rows[0]["开题答辩成绩txt"] < 60) {
                            $("#ktdb").html('<i class="txt_red">' + data.rows[0]["开题答辩成绩txt"] + '</i>');
                        } else {
                            $("#ktdb").text(data.rows[0]["开题答辩成绩txt"]);
                        };
                        if (data.rows[0]["平时成绩"] < 60) {
                            $("#pscj").html('<i class="txt_red">' + data.rows[0]["平时成绩txt"] + '</i>');
                        } else {
                            $("#pscj").text(data.rows[0]["平时成绩txt"]);
                        };

                        $("#pycj").text(data.rows[0]["评阅专家成绩txt"])
                        //总成绩后的跳转按钮
                        $("#grade_html").off().on('click', function () {
                            openframe('查看成绩', 'Review/ScoreDetails.html', false);
                        }).show();
                    } else {
                        $("#p_tishi").text(data.message);
                        $("#nochoiceDiv").show();
                    };
                },
                error: function (err) {
                    console.log(err);
                }
            });
        };
        //获取我的成绩结束
        //统一导出文档
        $("#derive").off().on('click', function () {
            GetWordList("15")
        });
        function GetWordList(type) {
            $.ajax({
                url: "../Handler/WordHandler.ashx",
                type: "post",
                dataType: "json",
                data: {
                    action: "ExportWordForStudent",
                    wordFileType: type
                },
                success: function (data) {
                    if (data.isSuccess) {
                        showOutputList();
                    } else {
                        myMessage(data.message);
                    };
                },
                error: function (err) {
                    console.log(err);
                }
            });
        };
        //获取说明的模板类型
        function GetExplain_type() {
            $.ajax({
                url: "../Handler/WordHandler.ashx",
                type: "post",
                dataType: "json",
                data: {
                    action: "GetAllWordFileType",
                },
                success: function (data) {
                    if (data.isSuccess && data.rows.length > 0) {
                        var str = '';
                        for (var i = 0; i < data.rows.length; i++) {
                            str += data.rows[i]["类型名称"] + '&nbsp;&nbsp;';
                        };
                        $("#explain_type").html(str);

                        var strinput = '';
                        for (var i = 0; i < data.rows.length; i++) {
                            strinput += "<input class=\"radio-margl\" id=\"aa_" + i + "\" name=\"danxuan\"  type=\"radio\"  value=\"" + data.rows[i]["类型"] + "\" /><label for=\"aa_" + i + "\">" + data.rows[i]["类型名称"] + "</lable>";
                        };
                        $("#radioType").html(strinput);
                    } else {
                        $("#explain_type").parent().html('<span class="SAtext">未设置模板文件</span>');
                        $("#radioType").html('<span class="margl">未设置模板文件</span>');
                    };
                },
                error: function (err) {
                    console.log(err);
                }
            });
        };
        //点击导出已配置的文档
        $("#configuration").off().on('click', function () {
            //打开弹框
            $("[name='danxuan']").eq(0).prop("checked", true);
            $("#popup").dialog({
                title: '导出已配置的文档的类型表',
                buttons: [{
                    text: '确定',
                    handler: function () {
                        if ($("#popup input").length <= 0) {
                            $("#popup").dialog("close");
                            return;
                        };
                        GetWordList($("#popup input[type='radio']:checked").val())
                        $("#popup").dialog("close");
                    }
                },
                {
                    text: '取消',
                    handler: function () {
                        $("#popup").dialog("close");
                    }
                }]
            });
            $("#popup").dialog('open').window('center');
        });

        // 师生预选
        function getPreSelectState() {
            $.ajax({
                url: "../Handler/MenuHandler.ashx",
                data: {
                    action: "GetMenuModuleState",
                    moduleId: 30
                },
                type: "post",
                dataType: "json",
                success: function (data) {
                    if (data.isSuccess) {
                        if (data.dataList && data.dataList.state == 1) {
                            getPreSelectDetails();
                            $("#preSelectBox").show();
                        }
                    };
                },
                error: function (err) {
                    console.log(err);
                }
            });
        };
        function getPreSelectDetails() {
            $.ajax({
                url: "../Handler/PreSelection.ashx",
                data: {
                    action: "GetStuPreSelectInfo"
                },
                type: "post",
                dataType: "json",
                success: function (data) {
                    if (data.isSuccess && data.rows && data.rows.length > 0) {
                        $("#preSelectTitleDetails").html(data.rows[0]["课题方向"] + '<a href="javascript:goToPreSelectList();" class="margl a-text">查看详情</a>');
                        var name = "";
                        if (data.rows[0]["姓名"]) {
                            name += data.rows[0]["姓名"];
                            if (data.rows[0]["教师编号"]) {
                                name += "（" + data.rows[0]["教师编号"] + "）";
                            }
                            if (data.rows[0]["学院名称"]) {
                                name += " / " + data.rows[0]["学院名称"];
                            }
                            if (data.rows[0]["职称"]) {
                                name += " / " + data.rows[0]["职称"];
                            }
                        }
                        $("#preSelectTeaName").html(name);
                        var telEmail = "";
                        if (data.rows[0]["邮箱"] && data.rows[0]["电话"]) {
                            telEmail += data.rows[0]["电话"] + " / " + data.rows[0]["邮箱"];
                        } else {
                            if (data.rows[0]["邮箱"]) {
                                telEmail += data.rows[0]["邮箱"];
                            }
                            if (data.rows[0]["电话"]) {
                                telEmail += data.rows[0]["电话"];
                            }
                        }
                        $("#preSelectTeaPhone").html(telEmail);
                    };
                },
                error: function (err) {
                    console.log(err);
                }
            });
        };
        function goToPreSelectList() {
            openframe('师生预选', '../PreSelection/StuPreSelect.html', true);
        };

        $("#switchover").on("click", function () {
            $.ajax({
                url: "../Handler/StuHome.ashx",
                data: {
                    action: "LoginLearningPlatform"
                },
                type: "post",
                dataType: "json",
                success: function (data) {
                    if (data.isSuccess) {
                        $.ajax({
                            url: "../Handler/StuHome.ashx",
                            data: {
                                action: "LearningPlatformTokenName"
                            },
                            type: "post",
                            dataType: "json",
                            success: function (newData) {
                                if (newData.isSuccess) {
                                    window.parent.location.href = "http://x.dev.cnki.net/read/article/AcademicThesis?filename=a0f38cb1-0048-46c8-8317-27f066097d25.xml&tablename="
                                        + "&dbcode=&fileSourceType=2&taskId=4389&appId=CRSP_PSMC_DEV&" + newData.message + "=" + data.message;
                                } else {
                                    window.parent.location.href = "http://x.dev.cnki.net/read/article/AcademicThesis?filename=a0f38cb1-0048-46c8-8317-27f066097d25.xml&tablename="
                                        + "&dbcode=&fileSourceType=2&taskId=4389&appId=CRSP_PSMC_DEV&token=" + data.message;
                                }
                            },
                            error: function (err) {
                                console.log(err);
                            }
                        });
                    } else {
                        myMessage(data.message);
                    }
                },
                error: function (err) {
                    console.log(err);
                }
            });
        });

    </script><div class="panel window panel-htop" style="display: none; width: 400px; left: 627px; top: 301px; z-index: 9002;"><div class="panel-header panel-header-noborder window-header" style="width: 400px;"><div class="panel-title">提示</div><div class="panel-tool"></div></div></div><div class="window-shadow" style="display: none; left: 627px; top: 301px; width: 400px; height: 200px; z-index: 9001;"></div><div class="window-mask" style="display: none; z-index: 9000; width: 1654px; height: 1283px;"></div>



<div class="panel combo-p panel-htop" style="position: absolute; z-index: 10; display: none;"><div class="combo-panel panel-body panel-body-noheader" title="" id="" style="overflow: hidden;"><div class="datebox-calendar-inner panel-noscroll"><div class="calendar calendar-noborder easyui-fluid" style="width: 1px; height: 180px;"><div class="calendar-header"><div class="calendar-nav calendar-prevmonth"></div><div class="calendar-nav calendar-nextmonth"></div><div class="calendar-nav calendar-prevyear"></div><div class="calendar-nav calendar-nextyear"></div><div class="calendar-title"><span class="calendar-text">五月 2020</span></div></div><div class="calendar-body" style="height: 156px;"><table class="calendar-dtable" cellspacing="0" cellpadding="0" border="0"><thead><tr><th>日</th><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th></tr></thead><tbody><tr class="calendar-first"><td class="calendar-day calendar-other-month calendar-sunday calendar-first " abbr="2020,4,26" style="">26</td><td class="calendar-day calendar-other-month " abbr="2020,4,27" style="">27</td><td class="calendar-day calendar-other-month " abbr="2020,4,28" style="">28</td><td class="calendar-day calendar-other-month " abbr="2020,4,29" style="">29</td><td class="calendar-day calendar-other-month " abbr="2020,4,30" style="">30</td><td class="calendar-day " abbr="2020,5,1" style="">1</td><td class="calendar-day calendar-saturday calendar-last " abbr="2020,5,2" style="">2</td></tr><tr class=""><td class="calendar-day calendar-sunday calendar-first " abbr="2020,5,3" style="">3</td><td class="calendar-day " abbr="2020,5,4" style="">4</td><td class="calendar-day " abbr="2020,5,5" style="">5</td><td class="calendar-day " abbr="2020,5,6" style="">6</td><td class="calendar-day " abbr="2020,5,7" style="">7</td><td class="calendar-day " abbr="2020,5,8" style="">8</td><td class="calendar-day calendar-saturday calendar-last " abbr="2020,5,9" style="">9</td></tr><tr class=""><td class="calendar-day calendar-sunday calendar-first " abbr="2020,5,10" style="">10</td><td class="calendar-day " abbr="2020,5,11" style="">11</td><td class="calendar-day " abbr="2020,5,12" style="">12</td><td class="calendar-day " abbr="2020,5,13" style="">13</td><td class="calendar-day " abbr="2020,5,14" style="">14</td><td class="calendar-day " abbr="2020,5,15" style="">15</td><td class="calendar-day calendar-saturday calendar-last " abbr="2020,5,16" style="">16</td></tr><tr class=""><td class="calendar-day calendar-sunday calendar-first " abbr="2020,5,17" style="">17</td><td class="calendar-day " abbr="2020,5,18" style="">18</td><td class="calendar-day " abbr="2020,5,19" style="">19</td><td class="calendar-day " abbr="2020,5,20" style="">20</td><td class="calendar-day " abbr="2020,5,21" style="">21</td><td class="calendar-day " abbr="2020,5,22" style="">22</td><td class="calendar-day calendar-saturday calendar-last " abbr="2020,5,23" style="">23</td></tr><tr class=""><td class="calendar-day calendar-sunday calendar-first " abbr="2020,5,24" style="">24</td><td class="calendar-day " abbr="2020,5,25" style="">25</td><td class="calendar-day " abbr="2020,5,26" style="">26</td><td class="calendar-day calendar-today calendar-selected " abbr="2020,5,27" style="">27</td><td class="calendar-day " abbr="2020,5,28" style="">28</td><td class="calendar-day " abbr="2020,5,29" style="">29</td><td class="calendar-day calendar-saturday calendar-last " abbr="2020,5,30" style="">30</td></tr><tr class="calendar-last"><td class="calendar-day calendar-sunday calendar-first " abbr="2020,5,31" style="">31</td><td class="calendar-day calendar-other-month " abbr="2020,6,1" style="">1</td><td class="calendar-day calendar-other-month " abbr="2020,6,2" style="">2</td><td class="calendar-day calendar-other-month " abbr="2020,6,3" style="">3</td><td class="calendar-day calendar-other-month " abbr="2020,6,4" style="">4</td><td class="calendar-day calendar-other-month " abbr="2020,6,5" style="">5</td><td class="calendar-day calendar-other-month calendar-saturday calendar-last " abbr="2020,6,6" style="">6</td></tr></tbody></table><div class="calendar-menu" style="display: none;"><div class="calendar-menu-year-inner"><span class="calendar-nav calendar-menu-prev"></span><span><input class="calendar-menu-year" type="text"></span><span class="calendar-nav calendar-menu-next"></span></div><div class="calendar-menu-month-inner"></div></div></div></div></div><div style="padding:2px"><input class="timespinner-f spinner-f textbox-f" style="display: none;"><span class="textbox spinner easyui-fluid" style="width: 0px;"><span class="textbox-addon textbox-addon-right" style="right: 0px; top: 0px;"><a href="javascript:;" class="textbox-icon spinner-button-updown" icon-index="0" tabindex="-1" style="width: 26px; height: 25px;"><span class="spinner-arrow spinner-button-top"><span class="spinner-arrow-up"></span></span><span class="spinner-arrow spinner-button-bottom"><span class="spinner-arrow-down"></span></span></a></span><input id="_easyui_textbox_input2" type="text" class="textbox-text validatebox-text textbox-prompt" autocomplete="off" tabindex="" placeholder="" style="margin: 0px 26px 0px 0px; padding-top: 0px; padding-bottom: 0px; height: 25px; line-height: 25px; width: 0px;"><input type="hidden" class="textbox-value" value=""></span></div></div></div><div class="panel combo-p panel-htop" style="position: absolute; z-index: 10; display: none;"><div class="combo-panel panel-body panel-body-noheader" title="" id="" style="overflow: hidden;"><div class="datebox-calendar-inner panel-noscroll"><div class="calendar calendar-noborder easyui-fluid" style="width: 1px; height: 180px;"><div class="calendar-header"><div class="calendar-nav calendar-prevmonth"></div><div class="calendar-nav calendar-nextmonth"></div><div class="calendar-nav calendar-prevyear"></div><div class="calendar-nav calendar-nextyear"></div><div class="calendar-title"><span class="calendar-text">五月 2020</span></div></div><div class="calendar-body" style="height: 156px;"><table class="calendar-dtable" cellspacing="0" cellpadding="0" border="0"><thead><tr><th>日</th><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th></tr></thead><tbody><tr class="calendar-first"><td class="calendar-day calendar-other-month calendar-sunday calendar-first " abbr="2020,4,26" style="">26</td><td class="calendar-day calendar-other-month " abbr="2020,4,27" style="">27</td><td class="calendar-day calendar-other-month " abbr="2020,4,28" style="">28</td><td class="calendar-day calendar-other-month " abbr="2020,4,29" style="">29</td><td class="calendar-day calendar-other-month " abbr="2020,4,30" style="">30</td><td class="calendar-day " abbr="2020,5,1" style="">1</td><td class="calendar-day calendar-saturday calendar-last " abbr="2020,5,2" style="">2</td></tr><tr class=""><td class="calendar-day calendar-sunday calendar-first " abbr="2020,5,3" style="">3</td><td class="calendar-day " abbr="2020,5,4" style="">4</td><td class="calendar-day " abbr="2020,5,5" style="">5</td><td class="calendar-day " abbr="2020,5,6" style="">6</td><td class="calendar-day " abbr="2020,5,7" style="">7</td><td class="calendar-day " abbr="2020,5,8" style="">8</td><td class="calendar-day calendar-saturday calendar-last " abbr="2020,5,9" style="">9</td></tr><tr class=""><td class="calendar-day calendar-sunday calendar-first " abbr="2020,5,10" style="">10</td><td class="calendar-day " abbr="2020,5,11" style="">11</td><td class="calendar-day " abbr="2020,5,12" style="">12</td><td class="calendar-day " abbr="2020,5,13" style="">13</td><td class="calendar-day " abbr="2020,5,14" style="">14</td><td class="calendar-day " abbr="2020,5,15" style="">15</td><td class="calendar-day calendar-saturday calendar-last " abbr="2020,5,16" style="">16</td></tr><tr class=""><td class="calendar-day calendar-sunday calendar-first " abbr="2020,5,17" style="">17</td><td class="calendar-day " abbr="2020,5,18" style="">18</td><td class="calendar-day " abbr="2020,5,19" style="">19</td><td class="calendar-day " abbr="2020,5,20" style="">20</td><td class="calendar-day " abbr="2020,5,21" style="">21</td><td class="calendar-day " abbr="2020,5,22" style="">22</td><td class="calendar-day calendar-saturday calendar-last " abbr="2020,5,23" style="">23</td></tr><tr class=""><td class="calendar-day calendar-sunday calendar-first " abbr="2020,5,24" style="">24</td><td class="calendar-day " abbr="2020,5,25" style="">25</td><td class="calendar-day " abbr="2020,5,26" style="">26</td><td class="calendar-day calendar-today calendar-selected " abbr="2020,5,27" style="">27</td><td class="calendar-day " abbr="2020,5,28" style="">28</td><td class="calendar-day " abbr="2020,5,29" style="">29</td><td class="calendar-day calendar-saturday calendar-last " abbr="2020,5,30" style="">30</td></tr><tr class="calendar-last"><td class="calendar-day calendar-sunday calendar-first " abbr="2020,5,31" style="">31</td><td class="calendar-day calendar-other-month " abbr="2020,6,1" style="">1</td><td class="calendar-day calendar-other-month " abbr="2020,6,2" style="">2</td><td class="calendar-day calendar-other-month " abbr="2020,6,3" style="">3</td><td class="calendar-day calendar-other-month " abbr="2020,6,4" style="">4</td><td class="calendar-day calendar-other-month " abbr="2020,6,5" style="">5</td><td class="calendar-day calendar-other-month calendar-saturday calendar-last " abbr="2020,6,6" style="">6</td></tr></tbody></table><div class="calendar-menu" style="display: none;"><div class="calendar-menu-year-inner"><span class="calendar-nav calendar-menu-prev"></span><span><input class="calendar-menu-year" type="text"></span><span class="calendar-nav calendar-menu-next"></span></div><div class="calendar-menu-month-inner"></div></div></div></div></div><div style="padding:2px"><input class="timespinner-f spinner-f textbox-f" style="display: none;"><span class="textbox spinner easyui-fluid" style="width: 0px;"><span class="textbox-addon textbox-addon-right" style="right: 0px; top: 0px;"><a href="javascript:;" class="textbox-icon spinner-button-updown" icon-index="0" tabindex="-1" style="width: 26px; height: 25px;"><span class="spinner-arrow spinner-button-top"><span class="spinner-arrow-up"></span></span><span class="spinner-arrow spinner-button-bottom"><span class="spinner-arrow-down"></span></span></a></span><input id="_easyui_textbox_input4" type="text" class="textbox-text validatebox-text textbox-prompt" autocomplete="off" tabindex="" placeholder="" style="margin: 0px 26px 0px 0px; padding-top: 0px; padding-bottom: 0px; height: 25px; line-height: 25px; width: 0px;"><input type="hidden" class="textbox-value" value=""></span></div></div></div><div class="panel window panel-htop" style="display: none; width: 600px; left: 527px; top: 271px;"><div class="panel-header panel-header-noborder window-header" style="width: 600px;"><div class="panel-title">New Dialog</div><div class="panel-tool"><a href="javascript:;" class="panel-tool-close"></a></div></div><div id="popup" class="easyui-dialog panel-body panel-body-noborder window-body" data-options="closed:true" style="padding-top: 10px; width: 600px; height: 224px;" title="">
                        <ul id="radioType" class="addFormBuild"><input class="radio-margl" id="aa_0" name="danxuan" type="radio" value="3"><label for="aa_0">任务书<input class="radio-margl" id="aa_1" name="danxuan" type="radio" value="7"><label for="aa_1">指导教师评阅意见书<input class="radio-margl" id="aa_2" name="danxuan" type="radio" value="8"><label for="aa_2">评阅专家评阅意见书<input class="radio-margl" id="aa_3" name="danxuan" type="radio" value="9"><label for="aa_3">指导记录<input class="radio-margl" id="aa_4" name="danxuan" type="radio" value="14"><label for="aa_4">答辩录入员评阅意见书</label></label></label></label></label></ul>
                    </div></div><div class="window-shadow" style="display: none; left: 527px; top: 271px; width: 600px; height: 260px;"></div><div class="panel window panel-htop" style="display: none; width: 450px; left: 602px; top: 271px;"><div class="panel-header panel-header-noborder window-header" style="width: 450px;"><div class="panel-title">New Dialog</div><div class="panel-tool"><a href="javascript:;" class="panel-tool-close"></a></div></div><div id="delmessagebox" class="easyui-dialog panel-body panel-body-noborder window-body" style="padding: 10px; overflow-wrap: break-word; width: 450px; height: 224px;" data-options="closed:true,modal:true" title=""></div></div><div class="window-shadow" style="display: none; left: 602px; top: 271px; width: 450px; height: 260px;"></div><div class="window-mask" style="display:none"></div><div class="panel window panel-htop" style="display: none; width: 500px; left: 577px; top: 254px;"><div class="panel-header panel-header-noborder window-header" style="width: 500px;"><div class="panel-title">New Dialog</div><div class="panel-tool"><a href="javascript:;" class="panel-tool-close"></a></div></div><div id="wechartModel" class="easyui-dialog panel-body panel-body-noborder window-body" data-options="closed:true,modal: true" style="text-align: center; width: 500px;" title="">
                <img src="./weixindigg.jpg" alt="二维码">
            </div></div><div class="window-shadow" style="display: none; left: 577px; top: 254px; width: 500px; height: 295px;"></div><div class="window-mask" style="display:none"></div><div class="panel window panel-htop" style="display: none; width: 400px; left: 635px; top: 281px;"><div class="panel-header panel-header-noborder window-header" style="width: 400px;"><div class="panel-title">New Dialog</div><div class="panel-tool"><a href="javascript:;" class="panel-tool-close"></a></div></div><div id="createLiveBox" class="easyui-dialog panel-body panel-body-noborder window-body" style="padding: 10px; width: 400px; height: 204px;" data-options="closed:true,modal:true" title="">
            <!--<input id="answerTime" type="hidden" name="hiden" value="" />
            <input id="maxTime" type="hidden" name="hiden" value="" />-->
            <div id="tips" class="statement txt_red"></div>
            <div style="line-height: 2em;">
                <span>直播开始时间：</span>
                <input id="TimeBegin" class="easyui-datetimebox margl combo-f textbox-f datetimebox-f" style="width: 175px; display: none;" data-options="showSeconds:false,editable: false" panelheight="270"><span class="textbox combo datebox" style="width: 175px;"><span class="textbox-addon textbox-addon-right" style="right: 0px; top: 0px;"><a href="javascript:;" class="textbox-icon combo-arrow" icon-index="0" tabindex="-1" style="width: 26px; height: 25px;"></a></span><input id="_easyui_textbox_input1" type="text" class="textbox-text validatebox-text validatebox-readonly textbox-prompt" autocomplete="off" tabindex="" readonly="" placeholder="" style="margin: 0px 26px 0px 0px; padding-top: 0px; padding-bottom: 0px; height: 25px; line-height: 25px; width: 149px;"><input type="hidden" class="textbox-value" name="" value=""></span>
            </div>
            <div style="line-height: 2em; margin-top: 10px;">
                <span>直播结束时间：</span>
                <input id="TimeEnd" class="easyui-datetimebox margl combo-f textbox-f datetimebox-f" style="width: 175px; display: none;" data-options="showSeconds:false,editable: false" panelheight="270"><span class="textbox combo datebox" style="width: 175px;"><span class="textbox-addon textbox-addon-right" style="right: 0px; top: 0px;"><a href="javascript:;" class="textbox-icon combo-arrow" icon-index="0" tabindex="-1" style="width: 26px; height: 25px;"></a></span><input id="_easyui_textbox_input3" type="text" class="textbox-text validatebox-text validatebox-readonly textbox-prompt" autocomplete="off" tabindex="" readonly="" placeholder="" style="margin: 0px 26px 0px 0px; padding-top: 0px; padding-bottom: 0px; height: 25px; line-height: 25px; width: 149px;"><input type="hidden" class="textbox-value" name="" value=""></span>
            </div>
        </div></div><div class="window-shadow" style="display: none; left: 635px; top: 281px; width: 400px; height: 240px;"></div><div class="window-mask" style="display:none"></div><div class="panel window panel-htop" style="display: none; width: 400px; left: 635px; top: 301px; z-index: 9005;"><div class="panel-header panel-header-noborder window-header" style="width: 400px;"><div class="panel-title">提示</div><div class="panel-tool"></div></div></div><div class="window-shadow" style="display: none; left: 635px; top: 301px; width: 400px; height: 200px; z-index: 9004;"></div><div class="window-mask" style="display: none; z-index: 9003; position: fixed;"></div><div class="panel window panel-htop" style="display: none; width: 400px; left: 635px; top: 301px; z-index: 9008;"><div class="panel-header panel-header-noborder window-header" style="width: 400px;"><div class="panel-title" style="">提示</div><div class="panel-tool"></div></div></div><div class="window-shadow" style="display: none; left: 635px; top: 301px; width: 400px; height: 200px; z-index: 9007;"></div><div class="window-mask" style="display: none; z-index: 9006; position: fixed;"></div></body></html>