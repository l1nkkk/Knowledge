> 难度：中等
- 思路：用一个map存src和copy之间的映射
  - 第一轮先构造拷贝和赋值next
  - 第二轮循环利用map来赋值random

> 题目
- https://leetcode-cn.com/problems/copy-list-with-random-pointer/

<div align="center" style="zoom:80%"><img src="pic/138.1.png"></div>

> 代码

```cpp
/*
// Definition for a Node.
class Node {
public:
    int val;
    Node* next;
    Node* random;
    
    Node(int _val) {
        val = _val;
        next = NULL;
        random = NULL;
    }
};
*/

class Solution {
public:
    Node* copyRandomList(Node* head) {
        if(head == nullptr) return nullptr;
        // 记录，节点和节点的对应
        map<Node*, Node*> srcToCopy;
        
        Node* srcIt = head;
        Node* copyHead = nullptr;
        Node* copyIt = nullptr;

        static int count = 0;
        while(srcIt != nullptr){
            if(copyHead == nullptr){
                copyHead = new Node(srcIt->val);
                copyIt = copyHead;
            }else{
                copyIt->next = new Node(srcIt->val);
                copyIt = copyIt->next;
            }
            srcToCopy[srcIt] = copyIt;
            srcIt = srcIt->next;
        }

        // 处理random
        srcIt = head;
        copyIt = copyHead;
        while(srcIt != nullptr){
            if(srcIt->random != nullptr){
                copyIt->random = srcToCopy[srcIt->random];
            }
            copyIt = copyIt->next;
            srcIt = srcIt->next;
        }
        return copyHead;
    }
};
```